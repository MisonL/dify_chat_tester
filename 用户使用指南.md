<div align="center">
  
# 🤖 AI 聊天客户端测试工具
## 📚 普通用户使用指南

### 🌟 从零开始，轻松上手
#### 本指南将带您完成从环境准备到程序使用的全过程

[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![VSCode](https://img.shields.io/badge/VSCode-1.60+-blue.svg)](https://code.visualstudio.com/)

</div>

---

## 📑 目录

| 序号 | 内容 | 页码 |
|------|------|------|
| 1️⃣ | [准备工作](#1-准备工作) |  |
| 2️⃣ | [安装 VSCode](#2-安装-vscode) |  |
| 3️⃣ | [安装 Python](#3-安装-python) |  |
| 4️⃣ | [安装 Git for Windows](#4-安装-git-for-windows) |  |
| 5️⃣ | [克隆项目](#5-克隆项目) |  |
| 6️⃣ | [使用 VSCode 打开项目](#6-使用-vscode-打开项目) |  |
| 7️⃣ | [安装 uv 包管理器](#7-安装-uv-包管理器) |  |
| 8️⃣ | [安装项目依赖](#8-安装项目依赖) |  |
| 9️⃣ | [程序使用方法](#9-程序使用方法) |  |
| 🔟 | [常见问题](#10-常见问题) |  |

---

## 1. ✅ 准备工作

在开始之前，请确保您的电脑满足以下要求：

| 📋 要求项目 | 📝 具体说明 |
|------------|------------|
| 💻 **操作系统** | Windows 10 或更高版本 |
| 🌐 **网络连接** | 稳定的互联网连接 |
| 💾 **磁盘空间** | 至少 1GB 可用空间 |
| 🔑 **权限要求** | 管理员权限（安装软件时需要） |

---

## 2. 📝 安装 VSCode

### 🎯 什么是 VSCode？
VSCode（Visual Studio Code）是微软开发的免费代码编辑器，界面友好，功能强大。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://code.visualstudio.com/

2. **⬇️ 下载安装包**
   - 点击页面上的 "Download for Windows" 按钮
   - 会自动下载 `VSCodeUserSetup-x64.x.x.x.exe` 文件

3. **⚙️ 安装程序**
   - 双击下载的安装文件
   - 同意用户协议，点击"下一步"
   - 保持默认设置，一路点击"下一步"
   - 最后点击"安装"
   - 安装完成后，勾选"运行 VSCode"，点击"完成"

4. **✅ 验证安装**
   - VSCode 会自动打开
   - 关闭欢迎页面，看到主界面即安装成功

### 🌍 VSCode 初始化配置（首次使用）

#### 1. 设置简体中文界面

如果您更喜欢中文界面，可以按以下步骤设置：

1. **打开扩展面板**
   - 按 `Ctrl + Shift + X` 打开扩展面板
   - 或点击左侧活动栏的扩展图标（四个方块）

2. **搜索中文语言包**
   - 在搜索框中输入：`Chinese`
   - 找到"Chinese (Simplified) (简体中文) Language Pack for Visual Studio Code"
   - 点击"安装"按钮

3. **切换语言**
   - 安装完成后，按 `Ctrl + Shift + P` 打开命令面板
   - 输入：`Configure Display Language`
   - 选择"zh-cn"（简体中文）
   - VSCode 会提示重启，点击"重启"
   - **注意**：如果界面已经是中文，菜单项会显示为"配置显示语言"

4. **验证语言设置**
   - 重启后，界面应该变为中文

#### 2. 设置 Git Bash 为默认终端

为了获得更好的体验，建议将 VSCode 的默认终端设置为 Git Bash：

1. **打开命令面板**
   - 按 `Ctrl + Shift + P` 打开命令面板
   - 或点击菜单栏"查看" → "命令面板"
   - **注意**：如果界面已经是中文，菜单项会显示为"查看" → "命令面板"

2. **搜索终端设置命令**
   - 在顶部出现的搜索框中，点击或输入：`>`
   - 输入：`终端：选择默认配置文件`
   - **注意**：搜索时会显示匹配的命令列表

3. **选择并执行命令**
   - 在列表中找到第二项："终端: 选择默认配置文件"
   - 点击该项或按回车键执行

4. **选择 Git Bash**
   - 在弹出的终端选择界面中，找到"Git Bash"选项
   - 点击选择"Git Bash"
   - 选择后，VSCode 会自动应用设置

5. **验证设置**
   - 关闭当前终端（Ctrl + \）
   - 重新打开终端（Ctrl + \）
   - 现在应该显示 Git Bash 样式的提示符（通常以 `<div align="center">
  
# 🤖 AI 聊天客户端测试工具
## 📚 普通用户使用指南

### 🌟 从零开始，轻松上手
#### 本指南将带您完成从环境准备到程序使用的全过程

[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![VSCode](https://img.shields.io/badge/VSCode-1.60+-blue.svg)](https://code.visualstudio.com/)

</div>

---

## 📑 目录

| 序号 | 内容 | 页码 |
|------|------|------|
| 1️⃣ | [准备工作](#1-准备工作) |  |
| 2️⃣ | [安装 VSCode](#2-安装-vscode) |  |
| 3️⃣ | [安装 Python](#3-安装-python) |  |
| 4️⃣ | [安装 Git for Windows](#4-安装-git-for-windows) |  |
| 5️⃣ | [克隆项目](#5-克隆项目) |  |
| 6️⃣ | [使用 VSCode 打开项目](#6-使用-vscode-打开项目) |  |
| 7️⃣ | [安装 uv 包管理器](#7-安装-uv-包管理器) |  |
| 8️⃣ | [安装项目依赖](#8-安装项目依赖) |  |
| 9️⃣ | [程序使用方法](#9-程序使用方法) |  |
| 🔟 | [常见问题](#10-常见问题) |  |

---

## 1. ✅ 准备工作

在开始之前，请确保您的电脑满足以下要求：

| 📋 要求项目 | 📝 具体说明 |
|------------|------------|
| 💻 **操作系统** | Windows 10 或更高版本 |
| 🌐 **网络连接** | 稳定的互联网连接 |
| 💾 **磁盘空间** | 至少 1GB 可用空间 |
| 🔑 **权限要求** | 管理员权限（安装软件时需要） |

---

## 2. 📝 安装 VSCode

### 🎯 什么是 VSCode？
VSCode（Visual Studio Code）是微软开发的免费代码编辑器，界面友好，功能强大。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://code.visualstudio.com/

2. **⬇️ 下载安装包**
   - 点击页面上的 "Download for Windows" 按钮
   - 会自动下载 `VSCodeUserSetup-x64.x.x.x.exe` 文件

3. **⚙️ 安装程序**
   - 双击下载的安装文件
   - 同意用户协议，点击"下一步"
   - 保持默认设置，一路点击"下一步"
   - 最后点击"安装"
   - 安装完成后，勾选"运行 VSCode"，点击"完成"

4. **✅ 验证安装**
   - VSCode 会自动打开
   - 关闭欢迎页面，看到主界面即安装成功

### 🌍 VSCode 初始化配置（首次使用）

#### 1. 设置简体中文界面

如果您更喜欢中文界面，可以按以下步骤设置：

1. **打开扩展面板**
   - 按 `Ctrl + Shift + X` 打开扩展面板
   - 或点击左侧活动栏的扩展图标（四个方块）

2. **搜索中文语言包**
   - 在搜索框中输入：`Chinese`
   - 找到"Chinese (Simplified) (简体中文) Language Pack for Visual Studio Code"
   - 点击"安装"按钮

3. **切换语言**
   - 安装完成后，按 `Ctrl + Shift + P` 打开命令面板
   - 输入：`Configure Display Language`
   - 选择"zh-cn"（简体中文）
   - VSCode 会提示重启，点击"重启"
   - **注意**：如果界面已经是中文，菜单项会显示为"配置显示语言"

4. **验证语言设置**
   - 重启后，界面应该变为中文

#### 2. 设置 Git Bash 为默认终端

为了获得更好的体验，建议将 VSCode 的默认终端设置为 Git Bash：

1. **打开命令面板**
   - 按 `Ctrl + Shift + P` 打开命令面板
   - 或点击菜单栏"查看" → "命令面板"
   - **注意**：如果界面已经是中文，菜单项会显示为"查看" → "命令面板"

2. **搜索终端设置命令**
   - 在顶部出现的搜索框中，点击或输入：`>`
   - 输入：`终端：选择默认配置文件`
   - **注意**：搜索时会显示匹配的命令列表

3. **选择并执行命令**
   - 在列表中找到第二项："终端: 选择默认配置文件"
   - 点击该项或按回车键执行

4. **选择 Git Bash**
   - 在弹出的终端选择界面中，找到"Git Bash"选项
   - 点击选择"Git Bash"
   - 选择后，VSCode 会自动应用设置

5. **验证设置**
   - 关闭当前终端（Ctrl + \）
   - 重新打开终端（Ctrl + \）
    开头）

---

## 📋 目录

1. [准备工作](#1-准备工作)
2. [安装 VSCode](#2-安装-vscode)
3. [安装 Python](#3-安装-python)
4. [安装 Git for Windows](#4-安装-git-for-windows)
5. [克隆项目](#5-克隆项目)
6. [使用 VSCode 打开项目](#6-使用-vscode-打开项目)
7. [安装 uv 包管理器](#7-安装-uv-包管理器)
8. [安装项目依赖](#8-安装项目依赖)
9. [程序使用方法](#9-程序使用方法)
10. [常见问题](#10-常见问题)

---

## 1. 准备工作

在开始之前，请确保您的电脑满足以下要求：
- **操作系统**：Windows 10 或更高版本
- **网络连接**：稳定的互联网连接
- **磁盘空间**：至少 1GB 可用空间
- **权限**：管理员权限（安装软件时需要）

---

## 2. 安装 VSCode

### 什么是 VSCode？
VSCode（Visual Studio Code）是微软开发的免费代码编辑器，界面友好，功能强大。

### 安装步骤：

1. **访问官网**
   - 打开浏览器，访问：https://code.visualstudio.com/

2. **下载安装包**
   - 点击页面上的 "Download for Windows" 按钮
   - 会自动下载 `VSCodeUserSetup-x64.x.x.x.exe` 文件

3. **安装程序**
   - 双击下载的安装文件
   - 同意用户协议，点击"下一步"
   - 保持默认设置，一路点击"下一步"
   - 最后点击"安装"
   - 安装完成后，勾选"运行 VSCode"，点击"完成"

4. **验证安装**
   - VSCode 会自动打开
   - 关闭欢迎页面，看到主界面即安装成功

### 🌍 VSCode 初始化配置（首次使用）

#### 1. 设置简体中文界面

如果您更喜欢中文界面，可以按以下步骤设置：

1. **打开扩展面板**
   - 按 `Ctrl + Shift + X` 打开扩展面板
   - 或点击左侧活动栏的扩展图标（四个方块）

2. **搜索中文语言包**
   - 在搜索框中输入：`Chinese`
   - 找到"Chinese (Simplified) (简体中文) Language Pack for Visual Studio Code"
   - 点击"安装"按钮

3. **切换语言**
   - 安装完成后，按 `Ctrl + Shift + P` 打开命令面板
   - 输入：`Configure Display Language`
   - 选择"zh-cn"（简体中文）
   - VSCode 会提示重启，点击"重启"
   - **注意**：如果界面已经是中文，菜单项会显示为"配置显示语言"

4. **验证语言设置**
   - 重启后，界面应该变为中文

 开头）



---

## 3. 🐍 安装 Python

### 🎯 什么是 Python？
Python 是一种流行的编程语言，本程序需要 Python 环境才能运行。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://www.python.org/downloads/
   - 网站会自动检测您的系统并推荐合适的版本

2. **⬇️ 下载安装包**
   - 点击黄色的 "Download Python x.x.x" 按钮
   - 会下载 `python-x.x.x-amd64.exe` 文件

3. **⚙️ 安装 Python**
   - **ℹ️ 说明**："Add Python to PATH" 选项的作用是让您可以在任何目录下直接使用 `python` 命令
   - **💡 提示**：本项目使用 uv 管理 Python 环境，**不勾选**此选项也可以正常使用
   - 点击 "Install Now" 进行默认安装
   - 等待安装完成

4. **✅ 验证安装**
   - 按 `Win + R` 键，输入 `cmd`，回车打开命令提示符
   - 输入以下命令：
     ```bash
     python --version
     ```
   - 如果显示 Python 版本号（如 `Python 3.11.5`），说明安装成功

---

## 4. 📦 安装 Git for Windows

### 🎯 什么是 Git？
Git 是版本控制工具，用于下载和管理项目代码。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://git-scm.com/download/win

2. **⬇️ 下载安装包**
   - 会自动下载 `Git-x.x.x.x-64-bit.exe` 文件

3. **⚙️ 安装 Git**
   - 双击运行安装文件
   - 大部分步骤保持默认设置，直接点击"Next"
   - 在 "Choosing the default editor" 页面，选择 VSCode（如果已安装）
   - 继续点击"Next"直到安装完成

4. **✅ 验证安装**
   - 右键点击桌面，选择"Git Bash Here"
   - 输入：
     ```bash
     git --version
     ```
   - 如果显示版本号，说明安装成功

---

## 5. 克隆项目

### 什么是克隆？
克隆是将远程项目下载到本地的过程。

### 操作步骤：

1. **打开 Git Bash**
   - 在桌面任意位置右键，选择"Git Bash Here"
   - 注意：这会在桌面路径打开终端

2. **克隆项目到桌面**
   ```bash
   git clone http://gitlab-base.qdama.cn/Mison/dify-chat-tester.git
   ```
   - 项目会被克隆到桌面上

3. **进入项目目录**
   ```bash
   cd dify-chat_tester
   ```

5. **查看项目文件**
   ```bash
   ls -la
   ```
   您应该能看到多个文件，包括 `main.py`、`README.md` 等

---

## 6. 使用 VSCode 打开项目

### 操作步骤：

1. **启动 VSCode**
   - 从开始菜单启动 VSCode

2. **打开项目文件夹**
   - 点击菜单栏的"文件" → "打开文件夹"
   - 导航到桌面上的 `dify-chat_tester` 文件夹
   - 选择该文件夹，点击"选择文件夹"
   - **注意**：如果界面已经是中文，菜单项会显示为"文件" → "打开文件夹"

3. **查看项目结构**
   - 左侧会显示项目文件列表
   - 点击文件可以查看内容

---

## 7. 安装 uv 包管理器

### 什么是 uv？
uv 是一个快速的 Python 包管理器，用于安装和管理程序依赖。

### 安装步骤：

1. **打开 VSCode 终端**
   - 在 VSCode 中，按 `Ctrl + \` 打开终端
   - 或点击菜单栏"终端" → "新建终端"
   - **注意**：如果界面已经是中文，菜单项会显示为"终端" → "新建终端"

2. **安装 uv**
   - 在终端中输入以下命令：
     ```bash
     powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
     ```
   - 等待安装完成

3. **重启终端**
   - 关闭当前终端（点击终端右上角的 ×）
   - 重新打开终端（Ctrl + \）

4. **验证安装**
   ```bash
   uv --version
   ```
   如果显示版本号，说明安装成功

---

## 8. 安装项目依赖

### 什么是依赖？
依赖是程序运行所需要的其他软件包。

### 安装步骤：

1. **确保在项目目录**
   - VSCode 终端应该显示 `.../dify-chat_tester>`
   - 如果不在，请使用 `cd` 命令进入项目目录

2. **安装依赖**
   ```bash
   uv sync
   ```
   - 这会读取 `pyproject.toml` 文件，自动安装所有需要的包
   - 过程可能需要几分钟，请耐心等待

3. **验证安装**
   ```bash
   uv run python --version
   ```
   应该显示 Python 版本信息

---

## 9. 程序使用方法

### 9.1 首次配置

1. **创建配置文件**
   ```bash
   cp config.env.example config.env
   ```

2. **运行程序**
   ```bash
   uv run python main.py
   ```

3. **配置 AI 供应商**
   - 程序会显示支持的 AI 供应商列表
   - 选择您要使用的供应商（输入数字）
   - 根据提示输入 API 密钥等信息

### 9.2 使用模式

程序提供两种使用模式：

#### 🗣️ 会话模式（实时对话）
- **选择**：输入 `1`
- **用途**：单次对话测试
- **特点**：
  - 实时多轮对话
  - 自动维护上下文
  - 支持命令控制：
    - `exit`：退出程序
    - `/new`：重置对话

#### 📊 批量询问模式
- **选择**：输入 `2`
- **用途**：批量处理多个问题
- **特点**：
  - 从 Excel 文件读取问题
  - 批量发送到 AI
  - 实时保存结果到 Excel
  - 生成详细日志

### 9.3 批量模式详细说明

1. **准备 Excel 文件**
   - 使用项目提供的 `dify_chat_tester_template.xlsx` 作为模板
   - 在"问题"列填写要询问的问题
   - 其他列会自动填充

2. **运行批量模式**
   - 选择批量模式后，程序会：
     - 提示选择 Excel 文件
     - 显示找到的问题数量
     - 询问是否显示回答内容
     - 逐个发送问题并保存结果

3. **查看结果**
   - 结果保存在新生成的 Excel 文件中
   - 文件名格式：`batch_query_log_YYYYMMDD_HHMMSS.xlsx`
   - 包含每个问题的回答、时间戳、状态等信息

---

## 10. 常见问题

### Q1: 提示 "python 不是内部或外部命令"
**A**: Python 没有添加到系统路径。请重新安装 Python，确保勾选 "Add Python to PATH"。

### Q2: uv 安装失败
**A**: 尝试使用管理员权限运行 PowerShell，然后执行安装命令。

### Q3: 克隆项目时提示权限错误
**A**: 
1. 确保您有访问 GitLab 的权限
2. 如果是私有项目，需要配置 SSH 密钥
3. 联系项目管理员获取访问权限

### Q4: 程序运行时提示模块找不到
**A**: 
1. 确保在项目目录下运行
2. 执行 `uv sync` 重新安装依赖
3. 检查虚拟环境是否激活

### Q5: API 调用失败
**A**: 
1. 检查 API 密钥是否正确
2. 确认网络连接正常
3. 检查 API 服务地址是否正确

### Q6: Excel 文件打开失败
**A**: 
1. 确保 Excel 文件没有被其他程序占用
2. 检查文件权限
3. 尝试使用新的模板文件

### Q7: 如何更新程序？
**A**: 
1. 在项目目录打开 Git Bash
2. 执行：
   ```bash
   git pull
   ```
3. 重新运行 `uv sync` 更新依赖

---

## 💡 使用技巧

1. **保存配置**：首次配置后，信息会保存在 `config.env` 文件中，下次无需重新配置

2. **批量处理建议**：
   - 每次处理 50-100 个问题为宜
   - 设置合适的请求间隔（默认 1 秒）
   - 定期备份结果文件

3. **日志管理**：
   - 定期清理旧的日志文件
   - 重要结果及时备份

4. **性能优化**：
   - 关闭不必要的程序
   - 确保网络稳定
   - 使用 SSD 硬盘可提升性能

---

## 📞 获取帮助

如果遇到问题：

1. **查看文档**：阅读项目根目录的 `README.md` 文件
2. **检查日志**：查看程序输出的错误信息
3. **搜索问题**：将错误信息复制到搜索引擎搜索
4. **联系支持**：发送邮件到 1360962086@qq.com

---

## 🎉 开始使用

恭喜！您已经完成了所有安装和配置步骤。现在可以开始使用 AI 聊天客户端测试工具了。

### 💡 使用提示

- 遇到问题时不要慌张，大部分问题都有解决方案
- 可以先查阅[常见问题](#10-常见问题)部分
- 或查看项目根目录的 `README.md` 文件获取更多信息

### 📞 获取支持

如果需要帮助，可以：
1. 查看程序输出的错误信息
2. 将错误信息复制到搜索引擎搜索
3. 发送邮件到：1360962086@qq.com

---

*最后更新：2025年11月*