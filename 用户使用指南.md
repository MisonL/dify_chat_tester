<div align="center">
  
# 🤖 AI 聊天客户端测试工具
## 📚 普通用户使用指南

### 🌟 从零开始，轻松上手
#### 本指南将带您完成从环境准备到程序使用的全过程

[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![VSCode](https://img.shields.io/badge/VSCode-1.60+-blue.svg)](https://code.visualstudio.com/)

</div>

---

## 📑 目录

| 序号 | 内容 | 页码 |
|------|------|------|
| 1️⃣ | [准备工作](#1-准备工作) |  |
| 2️⃣ | [安装 VSCode](#2-安装-vscode) |  |
| 3️⃣ | [安装 Python](#3-安装-python) |  |
| 4️⃣ | [安装 Git for Windows](#4-安装-git-for-windows) |  |
| 5️⃣ | [克隆项目](#5-克隆项目) |  |
| 6️⃣ | [使用 VSCode 打开项目](#6-使用-vscode-打开项目) |  |
| 7️⃣ | [安装 uv 包管理器](#7-安装-uv-包管理器) |  |
| 8️⃣ | [安装项目依赖](#8-安装项目依赖) |  |
| 9️⃣ | [程序使用方法](#9-程序使用方法) |  |
| 🔟 | [常见问题](#10-常见问题) |  |

---

## 1. ✅ 准备工作

在开始之前，请确保您的电脑满足以下要求：

| 📋 要求项目 | 📝 具体说明 |
|------------|------------|
| 💻 **操作系统** | Windows 10 或更高版本 |
| 🌐 **网络连接** | 稳定的互联网连接 |
| 💾 **磁盘空间** | 至少 1GB 可用空间 |
| 🔑 **权限要求** | 管理员权限（安装软件时需要） |

---

## 2. 📝 安装 VSCode

### 🎯 什么是 VSCode？
VSCode（Visual Studio Code）是微软开发的免费代码编辑器，功能强大且易于使用。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://code.visualstudio.com/

2. **⬇️ 下载安装包**
   - 点击 "Download for Windows"
   - 会下载 `VSCodeUserSetup-x.x.x.x.exe` 文件

3. **⚙️ 安装 VSCode**
   - 双击运行安装文件
   - 勾选 "添加到PATH"（推荐）
   - 其他选项保持默认，点击"下一步"直到完成

4. **🔧 推荐插件**
   - 安装完成后，打开 VSCode
   - 点击左侧扩展图标（或按 `Ctrl+Shift+X`）
   - 搜索并安装以下插件：
     - `Chinese (Simplified) Language Pack` - 中文界面
     - `Python` - Python 支持
     - `GitLens` - Git 增强

---

## 3. 🐍 安装 Python

### 🎯 什么是 Python？
Python 是一种流行的编程语言，本程序需要 Python 环境才能运行。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://www.python.org/downloads/
   - 网站会自动检测您的系统并推荐合适的版本

2. **⬇️ 下载安装包**
   - 点击黄色的 "Download Python x.x.x" 按钮
   - 会下载 `python-x.x.x-amd64.exe` 文件

3. **⚙️ 安装 Python**
   - **ℹ️ 重要**：**勾选** "Add Python to PATH" 选项
   - 点击 "Install Now" 进行默认安装
   - 等待安装完成

4. **✅ 验证安装**
   - 按 `Win + R` 键，输入 `cmd`，回车打开命令提示符
   - 输入以下命令：
     ```bash
     python --version
     ```
   - 如果显示 Python 版本号（如 `Python 3.11.5`），说明安装成功

---

## 4. 📦 安装 Git for Windows

### 🎯 什么是 Git？
Git 是版本控制工具，用于下载和管理项目代码。

### 📥 安装步骤：

1. **🌐 访问官网**
   - 打开浏览器，访问：https://git-scm.com/download/win

2. **⬇️ 下载安装包**
   - 会自动下载 `Git-x.x.x.x-64-bit.exe` 文件

3. **⚙️ 安装 Git**
   - 双击运行安装文件
   - 大部分步骤保持默认设置，直接点击"Next"
   - 在 "Choosing the default editor" 页面，选择 VSCode（如果已安装）
   - 继续点击"Next"直到安装完成

4. **✅ 验证安装**
   - 右键点击桌面，选择"Git Bash Here"
   - 输入：
     ```bash
     git --version
     ```
   - 如果显示 Git 版本号，说明安装成功

---

## 5. 🚀 克隆项目

### 📥 获取项目代码

1. **打开 Git Bash**
   - 在任意文件夹右键，选择"Git Bash Here"

2. **克隆项目**
   ```bash
   git clone https://github.com/MisonL/dify_chat_tester.git
   ```

3. **进入项目目录**
   ```bash
   cd dify_chat_tester
   ```

---

## 6. 💻 使用 VSCode 打开项目

1. **打开 VSCode**
2. **打开项目**
   - 点击 "文件" → "打开文件夹"
   - 选择刚克隆的 `dify_chat_tester` 文件夹
   - 或在 VSCode 中按 `Ctrl+O` 选择文件夹

3. **打开集成终端**
   - 按 `Ctrl+``（反引号键）打开终端
   - 或点击菜单：终端 → 新建终端

---

## 7. 📦 安装 uv 包管理器

### 🎯 什么是 uv？
uv 是一个快速的 Python 包管理器，类似于 npm 或 yarn。

### 📥 安装步骤：

1. **在 VSCode 终端中运行**
   ```bash
   # Windows PowerShell
   powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
   
   # 或使用 cmd
   cmd /c "curl -LsSf https://astral.sh/uv/install.sh | sh"
   ```

2. **验证安装**
   ```bash
   uv --version
   ```

3. **重启终端**
   - 关闭当前终端，重新打开

---

## 8. ⚙️ 安装项目依赖

### 📦 安装所有依赖

1. **在项目根目录运行**
   ```bash
   uv sync
   ```

2. **等待安装完成**
   - uv 会自动创建虚拟环境并安装所有依赖
   - 看到 "Success" 提示表示安装完成

---

## 9. 🎮 程序使用方法

### 🚀 首次运行

1. **启动程序**
   ```bash
   uv run python main.py
   ```

2. **配置 API 密钥**
   - 程序会引导您配置各个 AI 供应商
   - 按照提示输入 API 密钥和相关信息

### 📋 配置步骤详解

#### Dify 配置
1. **API 服务器地址**
   - 官方平台：https://api.dify.ai/v1
   - 私有部署：使用您的部署地址

2. **API 密钥**
   - 格式：`app-xxxxx`
   - 输入时不会显示在屏幕上

3. **应用 ID**
   - 从工作流页面 URL 获取 UUID
   - 例如：`8579d967-06c9-4338-8fe3-3dc1fe9d1eb3`

#### OpenAI 配置
1. **API 基础 URL**
   - 官方：https://api.openai.com/v1
   - 自定义：使用您的服务地址

2. **API 密钥**
   - 格式：`sk-xxxxx`
   - 输入时不会显示在屏幕上

#### iFlow 配置
1. **API 密钥**
   - 从 https://platform.iflow.cn/profile?tab=apiKey 获取
   - 输入时不会显示在屏幕上

### 💬 会话模式使用

1. **选择模式**
   - 输入 `1` 选择会话模式

2. **选择角色**
   - 预设角色：员工、门店等
   - 内置选项：用户(user)
   - 自定义：输入任意角色名称

3. **开始对话**
   - 直接输入您的问题
   - AI 会实时回复

4. **特殊命令**
   - `/exit` 或 `/quit`：返回模式选择
   - `/new`：重置对话上下文

### 📊 批量模式使用

1. **准备 Excel 文件**
   - 使用提供的模板文件 `dify_chat_tester_template.xlsx`
   - 在 A 列填写要询问的问题

2. **选择模式**
   - 输入 `2` 选择批量模式

3. **选择 Excel 文件**
   - 输入文件路径或拖拽文件到终端

4. **开始处理**
   - 程序会自动处理所有问题
   - 结果实时写入原文件

---

## 10. ❓ 常见问题

### Q1: 程序启动失败怎么办？

**A:**
1. 确认 Python 版本：`python --version`
2. 确认 uv 已安装：`uv --version`
3. 确认在项目目录：`ls`
4. 重新安装依赖：`uv sync --reinstall`

### Q2: API 密钥输入后看不到？

**A:**
这是正常的安全设计，密钥输入时会自动隐藏。确认时会显示前几位和后几位，中间用 `*` 替代。

### Q3: Dify 提示"模型选择"怎么办？

**A:**
Dify 不需要选择模型，程序会自动使用应用配置的模型。如果出现选择提示，可能是配置问题。

### Q4: 批量处理速度太慢？

**A:**
1. 检查网络连接
2. 调整请求间隔：在 `config.env` 中修改 `BATCH_REQUEST_INTERVAL`
3. 减少同时处理的问题数量

### Q5: 如何查看对话历史？

**A:**
会话模式的所有对话都会自动保存在 `chat_log.xlsx` 文件中，包含完整的时间戳和对话内容。

### Q6: 程序崩溃或无响应？

**A:**
1. 按 `Ctrl+C` 强制退出
2. 检查错误日志
3. 重启程序
4. 如果问题持续，删除 `config.env` 重新配置

### Q7: 如何更新程序？

**A:**
```bash
git pull origin main
uv sync
```

### Q8: Excel 文件打不开或损坏？

**A:**
1. 确保使用 Microsoft Excel 或兼容软件
2. 不要在程序运行时手动编辑 Excel 文件
3. 备份重要数据

### Q9: 角色如何自定义？

**A:**
在角色选择时：
- 输入预设角色编号
- 输入 `len(预设角色)+1` 选择用户角色
- 输入 `len(预设角色)+2` 自定义角色
- 或直接输入自定义角色名称

### Q10: 如何切换 AI 供应商？

**A:**
1. 退出当前模式（输入 `/quit`）
2. 程序会返回供应商选择菜单
3. 选择新的供应商并配置

---

## 💡 使用技巧

### 🔧 配置优化

1. **批量处理建议**：
   - 每次处理 50-100 个问题为宜
   - 设置合适的请求间隔（默认 1 秒）
   - 定期备份结果文件

2. **日志管理**：
   - 定期清理旧的日志文件
   - 重要结果及时备份

3. **性能优化**：
   - 关闭不必要的程序
   - 确保网络稳定
   - 使用 SSD 硬盘可提升性能

### 🎯 最佳实践

1. **API 密钥安全**：
   - 不要分享 API 密钥
   - 定期更换密钥
   - 使用环境变量（高级用户）

2. **对话技巧**：
   - 使用 `/new` 开始新话题
   - 保持问题简洁明了
   - 合理使用上下文

3. **批量处理**：
   - 预先测试单个问题
   - 分批处理大量问题
   - 监控处理进度

---

## 📞 获取帮助

如果遇到问题：

1. **查看文档**：阅读项目根目录的 `README.md` 文件
2. **检查日志**：查看程序输出的错误信息
3. **搜索问题**：将错误信息复制到搜索引擎搜索
4. **联系支持**：发送邮件到 1360962086@qq.com

---

## 🎉 开始使用

恭喜！您已经完成了所有安装和配置步骤。现在可以开始使用 AI 聊天客户端测试工具了。

### 💡 使用提示

- 遇到问题时不要慌张，大部分问题都有解决方案
- 可以先查阅[常见问题](#10-常见问题)部分
- 或查看项目根目录的 `README.md` 文件获取更多信息

---

*最后更新：2025年11月*